{"is_source_file": true, "format": "Python", "description": "This file defines shared dependencies for a FastAPI backend related to authentication and authorization, including JWT token parsing, user retrieval, and role validation.", "external_files": ["src.api.db", "src.api.models.user", "src.api.security"], "external_methods": ["decode_token", "get_db"], "published": ["get_current_token_payload", "get_current_user_id", "get_current_user", "require_driver"], "classes": [{"name": "User", "description": "ORM model representing a user in the database."}, {"name": "UserRole", "description": "Enumeration of user roles, e.g., driver."}], "methods": [{"name": "HTTPException _unauthorized(detail: str)", "description": "Creates a standardized 401 HTTPException with WWW-Authenticate header.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] get_current_token_payload( credentials: HTTPAuthorizationCredentials | None = Depends(bearer_scheme), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "User get_current_user(db: Session = Depends(get_db), user_id: UUID = Depends(get_current_user_id))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UUID get_current_user_id(payload: Dict[str, Any] = Depends(get_current_token_payload))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "User require_driver(current_user: User = Depends(get_current_user))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["decode_token", "select(User).where(User.id == user_id)", "UUID(str(payload.get(\"sub\")))"], "search-terms": ["JWT dependencies", "FastAPI auth", "user role check", "JWT token parsing", "get_current_user"], "state": 2, "file_id": 16, "knowledge_revision": 34, "git_revision": "23b82ba9e8b2c4e5c12af7076dacb93007e4e990", "ctags": [{"_type": "tag", "name": "_unauthorized", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^def _unauthorized(detail: str) -> HTTPException:$/", "language": "Python", "typeref": "typename:HTTPException", "kind": "function", "signature": "(detail: str)"}, {"_type": "tag", "name": "bearer_scheme", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^bearer_scheme = HTTPBearer(auto_error=False)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_current_token_payload", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^def get_current_token_payload($/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "( credentials: HTTPAuthorizationCredentials | None = Depends(bearer_scheme), )"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^def get_current_user(db: Session = Depends(get_db), user_id: UUID = Depends(get_current_user_id)/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(db: Session = Depends(get_db), user_id: UUID = Depends(get_current_user_id))"}, {"_type": "tag", "name": "get_current_user_id", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^def get_current_user_id(payload: Dict[str, Any] = Depends(get_current_token_payload)) -> UUID:$/", "language": "Python", "typeref": "typename:UUID", "kind": "function", "signature": "(payload: Dict[str, Any] = Depends(get_current_token_payload))"}, {"_type": "tag", "name": "require_driver", "path": "/home/kavia/workspace/code-generation/rideconnect-201071-201080/taxi_backend/src/api/deps.py", "pattern": "/^def require_driver(current_user: User = Depends(get_current_user)) -> User:$/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(current_user: User = Depends(get_current_user))"}], "hash": "6fe172307fbf9a2538c9b204bfeedd1b", "format-version": 4, "code-base-name": "taxi_backend", "filename": "taxi_backend/src/api/deps.py", "fields": [{"name": "bearer_scheme = HTTPBearer(auto_error=False)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"34": "23b82ba9e8b2c4e5c12af7076dacb93007e4e990"}]}